<?phpnamespace App\Models;use App\Models\Item;use Illuminate\Database\Eloquent\Model;class Warehouse extends Model{    public function getItemInStock() {    	return $this->items()->where('status', Item::STATUS_IN_WAREHOUSE)->first();    }    public function items() {    	return $this->hasMany('App\Models\Item');    }    public function getWarehouseInfo() {        $x = $this->x;        $y = $this->y;        $warehouseSize  = Warehouse::where('x', $x)->where('y', $y)->count();         $warehouseId     = Warehouse::where('x', $x)->where('y', $y)->pluck('id');         $itemInWarehouse = Item::where('status', Item::STATUS_IN_WAREHOUSE)->whereIn('warehouse_id', $warehouseId)->count();                $hasDeadstock     = false;        foreach(Warehouse::where('x', $x)->where('y', $y)->get() as $warehouse) {            $item = $warehouse->getItemInStock();            if($item && $item->getDeadstockPeriod() <= 0) $hasDeadstock = true;        }        return [            'x'             => $x,             'y'             => $y,            'remaining'     => $itemInWarehouse,            'warehouseSize' => $warehouseSize,            'hasDeadstock'  => $hasDeadstock,        ];    }}